(function() {
  function Chessground(element, config) {
    this.element = element;
    this.config = config || {};
    this._init();
  }

  Chessground.prototype._init = function() {
    this.board = this._createBoard();
    this.element.appendChild(this.board);
    if (this.config.coordinates) {
      this._addCoordinates();
    }
  };

  Chessground.prototype._createBoard = function() {
    const board = document.createElement('div');
    board.classList.add('cg-board');
    for (let i = 0; i < 64; i++) {
      const square = document.createElement('div');
      square.classList.add('cg-square');
      if (Math.floor(i / 8) % 2 === i % 2) {
        square.classList.add('light');
      } else {
        square.classList.add('dark');
      }
      board.appendChild(square);
    }
    return board;
  };

  Chessground.prototype._addCoordinates = function() {
    // Add coordinates around the board if needed
  };

  Chessground.prototype.set = function(config) {
    if (config.fen) {
      this._setFEN(config.fen);
    }
  };

  Chessground.prototype._setFEN = function(fen) {
    const squares = this.board.querySelectorAll('.cg-square');
    const pieceMap = {
      'r': 'bR', 'n': 'bN', 'b': 'bB', 'q': 'bQ', 'k': 'bK', 'p': 'bP',
      'R': 'wR', 'N': 'wN', 'B': 'wB', 'Q': 'wQ', 'K': 'wK', 'P': 'wP'
    };
    squares.forEach(square => {
      square.style.backgroundImage = '';
    });
    const rows = fen.split(' ')[0].split('/');
    rows.forEach((row, rowIndex) => {
      let colIndex = 0;
      for (const char of row) {
        if (isNaN(char)) {
          const piece = pieceMap[char];
          squares[rowIndex * 8 + colIndex].style.backgroundImage = `url('piezas/${piece}.svg')`;
          colIndex++;
        } else {
          colIndex += parseInt(char);
        }
      }
    });
  };

  window.Chessground = Chessground;
})();